{% extends "base.html" %}

{% block content %}
<div class="fluent-card p-4">
    <h2 class="mb-4">生成测试用例</h2>
    <p class="text-muted mb-4">上传Excel需求文档和提示词文件，生成测试用例</p>
    
    <form method="POST" enctype="multipart/form-data">
        <!-- Excel文件上传 -->
        <div class="config-section">
            <h3>📊 Excel需求文档</h3>
            <p class="text-muted mb-3">请上传包含功能需求的Excel文件</p>
            <div class="file-upload-area">
                <input type="file" id="excel_file" name="excel_file" accept=".xlsx,.xls" required 
                       style="display: none;">
                <div class="file-upload-label" data-original-text="点击或拖拽Excel文件到这里">
                    点击或拖拽Excel文件到这里
                </div>
                <small class="text-muted">支持 .xlsx 和 .xls 格式</small>
            </div>
        </div>

        <!-- 提示词文件上传 -->
        <div class="config-section">
            <h3>📝 提示词文件（可选）</h3>
            <p class="text-muted mb-3">如果不上传，将使用内置提示词</p>
            
            <div class="form-row">
                <div class="fluent-form-group">
                    <label class="fluent-label">测试点提示词</label>
                    <div class="file-upload-area">
                        <input type="file" name="test_point_file" accept=".md,.txt" 
                               style="display: none;">
                        <div class="file-upload-label" data-original-text="点击选择测试点提示词文件">
                            点击选择测试点提示词文件
                        </div>
                        <small class="text-muted">支持 .md 和 .txt 格式</small>
                    </div>
                </div>
                
                <div class="fluent-form-group">
                    <label class="fluent-label">测试用例提示词</label>
                    <div class="file-upload-area">
                        <input type="file" name="test_case_file" accept=".md,.txt" 
                               style="display: none;">
                        <div class="file-upload-label" data-original-text="点击选择测试用例提示词文件">
                            点击选择测试用例提示词文件
                        </div>
                        <small class="text-muted">支持 .md 和 .txt 格式</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="fluent-alert fluent-alert-info">
            <strong>处理说明：</strong><br>
            • 最多保存100个文件，超过会自动清理旧文件<br>
            • 处理时间取决于数据量和AI响应速度<br>
            • 大文件可能需要几分钟时间处理<br>
            • 处理过程中请不要关闭页面
        </div>

        <div class="d-flex gap-3">
            <button type="submit" class="btn btn-primary">开始生成测试用例</button>
            <a href="{{ url_for('index') }}" class="btn btn-outline-secondary">返回首页</a>
        </div>
    </form>
</div>
{% endblock %}